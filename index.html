<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Электронный дневник</title>
  <style>
    body { font-family: 'Inter', sans-serif; margin:0; background:#f4f7fb; color:#333; }
    header { background: linear-gradient(135deg, #4facfe, #00f2fe); padding:1rem; text-align:center; color:white; font-size:1.5rem; font-weight:bold; }
    .days { display:flex; overflow-x:auto; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .day { min-width:120px; padding:0.7rem; text-align:center; font-weight:600; border-bottom:3px solid transparent; cursor:pointer; }
    .day.active { border-bottom:3px solid #4facfe; color:#4facfe; }
    .schedule { padding:1rem; }
    .lesson { background:white; margin-bottom:0.7rem; padding:0.9rem; border-radius:12px; box-shadow:0 2px 5px rgba(0,0,0,0.1); cursor:pointer; }
    .lesson h4 { margin:0 0 0.3rem 0; font-size:1rem; }
    .lesson small { color:#666; }
    .modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); display:none; justify-content:center; align-items:center; }
    .modal-content { background:white; padding:1rem; border-radius:16px; width:90%; max-height:80%; overflow-y:auto; }
    .modal-content h3 { margin-top:0; }
    .close-btn { background:#f44336; color:white; border:none; padding:0.5rem 1rem; border-radius:8px; cursor:pointer; float:right; }
  </style>
</head>
<body>
  <header>📘 Электронный дневник</header>
  <div class="days" id="days"></div>
  <div class="schedule" id="schedule"></div>

  <div class="modal" id="modal">
    <div class="modal-content">
      <button class="close-btn" onclick="closeModal()">Закрыть</button>
      <h3 id="modalTitle"></h3>
      <p id="homeworkDisplay"></p>
    </div>
  </div>

  <script>
    const daysOfWeek = ["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"];
    const dzUrl = "https://raw.githubusercontent.com/Romalakino/school-diary/main/dz.json";
    let scheduleData = {};
    let currentDay = daysOfWeek[0];

    async function fetchSchedule() {
      try {
        const res = await fetch(dzUrl);
        scheduleData = await res.json();
        renderDays();
        renderSchedule();
      } catch(e) {
        alert("Ошибка загрузки данных: " + e);
      }
    }

    function renderDays() {
      const container = document.getElementById("days");
      container.innerHTML = "";
      daysOfWeek.forEach(day=>{
        const div = document.createElement("div");
        div.className = "day" + (day===currentDay?" active":"");
        div.textContent = day;
        div.onclick = ()=>{currentDay=day; renderDays(); renderSchedule();};
        container.appendChild(div);
      });
    }

    function renderSchedule() {
      const container = document.getElementById("schedule");
      container.innerHTML = "";
      if(!scheduleData[currentDay]) return;
      scheduleData[currentDay].forEach((lesson,i)=>{
        const div = document.createElement("div");
        div.className = "lesson";
        div.innerHTML = `<h4>${i+1}. ${lesson.name}</h4><small>${lesson.teacher||""}</small>`;
        div.onclick = ()=>openModal(i);
        container.appendChild(div);
      });
    }

    function openModal(index) {
      const lesson = scheduleData[currentDay][index];
      document.getElementById("modalTitle").textContent = lesson.name;
      document.getElementById("homeworkDisplay").textContent = lesson.homework || "Домашка не задана";
      document.getElementById("modal").style.display = "flex";
    }

    function closeModal() {
      document.getElementById("modal").style.display = "none";
    }

    fetchSchedule();
  </script>
</body>
</html>
